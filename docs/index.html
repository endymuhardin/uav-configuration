<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panduan Setup ArduPilot - UAV Configuration</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÅ Panduan Interaktif Setup ArduPilot</h1>
            <p class="subtitle">Panduan Universal Setup ArduPilot untuk Semua Hardware</p>
        </header>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
            <div class="progress-text">
                <span id="progressText">0% Selesai</span>
            </div>
        </div>

        <nav class="step-nav">
            <button class="nav-btn" id="prevBtn" onclick="changeStep(-1)" disabled>‚Üê Sebelumnya</button>
            <div class="step-indicators" id="stepIndicators"></div>
            <button class="nav-btn" id="nextBtn" onclick="changeStep(1)">Selanjutnya ‚Üí</button>
        </nav>

        <main>
            <!-- Spesifikasi -->
            <section class="step-content" id="step0">
                <h2>üìã Konfigurasi Hardware</h2>
                
                <div class="config-actions">
                    <button class="btn-secondary" onclick="exportConfiguration()">üì§ Export Config</button>
                    <label for="importConfig" class="btn-secondary file-input-label">
                        üì• Import Config
                        <input type="file" id="importConfig" accept=".json" onchange="importConfiguration(event)" style="display: none;">
                    </label>
                    <button class="btn-secondary" onclick="resetHardwareConfig()">üîÑ Reset Default</button>
                    <button class="btn-danger" onclick="resetAllSettings()">üóëÔ∏è Reset All Settings</button>
                </div>

                <div class="hardware-config-form">
                    <h3>üîß Spesifikasi Hardware Anda</h3>
                    <p>Masukkan spesifikasi hardware drone Anda:</p>
                    
                    <div class="config-grid">
                        <div class="config-item">
                            <label for="fc-input">Flight Controller (FC):</label>
                            <input type="text" id="fc-input" class="hw-input" value="SpeedyBee F405 V4" 
                                   placeholder="Contoh: SpeedyBee F405 V4">
                        </div>
                        
                        <div class="config-item">
                            <label for="esc-input">ESC:</label>
                            <input type="text" id="esc-input" class="hw-input" value="SpeedyBee BLS 55A (DShot300)" 
                                   placeholder="Contoh: SpeedyBee BLS 55A">
                        </div>
                        
                        <div class="config-item">
                            <label for="receiver-input">Radio Receiver:</label>
                            <input type="text" id="receiver-input" class="hw-input" value="Matek RP4TD" 
                                   placeholder="Contoh: Matek RP4TD">
                        </div>
                        
                        <div class="config-item">
                            <label for="gps1-input">GPS 1 (Primary):</label>
                            <input type="text" id="gps1-input" class="hw-input" value="MicoAir M10G-5883" 
                                   placeholder="Contoh: MicoAir M10G-5883">
                        </div>
                        
                        <div class="config-item">
                            <label for="gps2-input">GPS 2 (Secondary):</label>
                            <input type="text" id="gps2-input" class="hw-input" value="" 
                                   placeholder="Contoh: MicoAir M10G-5883 (Opsional)">
                        </div>
                        
                        <div class="config-item">
                            <label for="motor-input">Motor:</label>
                            <input type="text" id="motor-input" class="hw-input" value="Emax Eco II 1750KV" 
                                   placeholder="Contoh: Emax Eco II 1750KV">
                        </div>
                        
                        <div class="config-item">
                            <label for="battery-input">Baterai:</label>
                            <select id="battery-input" class="hw-input">
                                <option value="6s">6S (22.2V - 25.2V)</option>
                                <option value="4s">4S (14.8V - 16.8V)</option>
                                <option value="5s">5S (18.5V - 21V)</option>
                                <option value="3s">3S (11.1V - 12.6V)</option>
                            </select>
                        </div>
                        
                        <div class="config-item">
                            <label for="frame-size-input">Ukuran Frame (inch):</label>
                            <input type="text" id="frame-size-input" class="hw-input" value="5" 
                                   placeholder="Contoh: 5, 7, 10, 20, dll">
                        </div>
                        
                        <div class="config-item">
                            <label for="frame-class-input">Frame Class:</label>
                            <select id="frame-class-input" class="hw-input">
                                <option value="1">Quad (4 motors)</option>
                                <option value="2">Hexa (6 motors)</option>
                                <option value="3">Octa (8 motors)</option>
                                <option value="4">OctaQuad (8 motors coaxial)</option>
                                <option value="5">Y6 (6 motors coaxial)</option>
                                <option value="7">Tri (3 motors)</option>
                                <option value="8">SingleCopter (1 motor)</option>
                                <option value="9">CoaxCopter (2 motors)</option>
                            </select>
                        </div>
                        
                        <div class="config-item">
                            <label for="frame-type-input">Frame Type:</label>
                            <select id="frame-type-input" class="hw-input">
                                <!-- Will be populated dynamically based on frame class -->
                            </select>
                        </div>
                        
                        <div class="config-item">
                            <label for="vtx-type-select">Tipe VTX:</label>
                            <select id="vtx-type-select" class="hw-input">
                                <option value="walksnail">Walksnail/Avatar HD</option>
                                <option value="dji">DJI (dengan WTF-OSD)</option>
                                <option value="analog">Analog/Traditional</option>
                                <option value="hdzero">HDZero</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="peripheral-config">
                        <h4>üîå Konfigurasi Peripheral</h4>
                        <p>Pilih peripheral yang terpasang pada drone Anda:</p>
                        
                        <div class="config-grid">
                            <div class="config-item">
                                <label>
                                    <input type="checkbox" id="peripheral-gps1" class="peripheral-checkbox" checked>
                                    GPS Module 1 (Primary)
                                </label>
                                <select id="gps1-uart-select" class="hw-input peripheral-uart">
                                    <option value="UART6" selected>UART6</option>
                                    <option value="UART1">UART1</option>
                                    <option value="UART2">UART2</option>
                                    <option value="UART3">UART3</option>
                                    <option value="UART4">UART4</option>
                                    <option value="UART5">UART5</option>
                                </select>
                            </div>

                            <div class="config-item">
                                <label>
                                    <input type="checkbox" id="peripheral-gps2" class="peripheral-checkbox">
                                    GPS Module 2 (Secondary)
                                </label>
                                <select id="gps2-uart-select" class="hw-input peripheral-uart">
                                    <option value="UART5" selected>UART5</option>
                                    <option value="UART1">UART1</option>
                                    <option value="UART2">UART2</option>
                                    <option value="UART3">UART3</option>
                                    <option value="UART4">UART4</option>
                                    <option value="UART6">UART6</option>
                                </select>
                            </div>
                            
                            <div class="config-item">
                                <label>
                                    <input type="checkbox" id="peripheral-vtx" class="peripheral-checkbox" checked>
                                    VTX (OSD)
                                </label>
                                <div class="vtx-config-details" style="margin-top: 10px;">
                                    <select id="vtx-protocol-select" class="hw-input" style="margin-bottom: 8px;">
                                        <option value="displayport">DisplayPort (HD VTX)</option>
                                        <option value="none">Tidak ada OSD</option>
                                    </select>
                                    <select id="vtx-uart-select" class="hw-input peripheral-uart">
                                        <option value="UART1" selected>UART1</option>
                                        <option value="UART2">UART2</option>
                                        <option value="UART3">UART3</option>
                                        <option value="UART4">UART4</option>
                                        <option value="UART5">UART5</option>
                                        <option value="UART6">UART6</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="config-item rc-receiver-section">
                                <label>
                                    <input type="checkbox" id="peripheral-rc-receiver" class="peripheral-checkbox" checked>
                                    RC Receiver
                                </label>
                                <div class="rc-config-details">
                                    <label for="rc-receiver-type">Tipe RC Receiver:</label>
                                    <select id="rc-receiver-type" class="hw-input">
                                        <option value="expresslrs">ExpressLRS</option>
                                        <option value="crossfire">TBS Crossfire</option>
                                        <option value="frsky">FrSky</option>
                                        <option value="spektrum">Spektrum</option>
                                        <option value="flysky">FlySky</option>
                                        <option value="generic">Generic</option>
                                    </select>
                                    
                                    <label for="rc-protocol">Protokol:</label>
                                    <select id="rc-protocol" class="hw-input">
                                        <option value="crsf" selected>CRSF</option>
                                        <option value="mavlink">MavLink (telemetry)</option>
                                        <option value="sbus">SBUS</option>
                                        <option value="ppm">PPM</option>
                                        <option value="dsm">DSM/DSMX</option>
                                    </select>
                                    
                                    <label for="rc-uart-select">UART Port:</label>
                                    <select id="rc-uart-select" class="hw-input peripheral-uart">
                                        <option value="UART2" selected>UART2</option>
                                        <option value="UART1">UART1</option>
                                        <option value="UART3">UART3</option>
                                        <option value="UART4">UART4</option>
                                        <option value="UART5">UART5</option>
                                        <option value="UART6">UART6</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="config-item">
                                <label>
                                    <input type="checkbox" id="peripheral-esc-telem" class="peripheral-checkbox" checked>
                                    ESC Telemetry
                                </label>
                                <select id="esc-telem-uart-select" class="hw-input peripheral-uart">
                                    <option value="UART5" selected>UART5</option>
                                    <option value="UART1">UART1</option>
                                    <option value="UART2">UART2</option>
                                    <option value="UART3">UART3</option>
                                    <option value="UART4">UART4</option>
                                    <option value="UART6">UART6</option>
                                </select>
                            </div>
                            
                            <div class="config-item">
                                <label>
                                    <input type="checkbox" id="peripheral-rangefinder" class="peripheral-checkbox">
                                    Rangefinder/Lidar
                                </label>
                                <select id="rangefinder-uart-select" class="hw-input peripheral-uart">
                                    <option value="UART3" selected>UART3</option>
                                    <option value="UART1">UART1</option>
                                    <option value="UART2">UART2</option>
                                    <option value="UART4">UART4</option>
                                    <option value="UART5">UART5</option>
                                    <option value="UART6">UART6</option>
                                </select>
                            </div>
                            
                            <div class="config-item">
                                <label>
                                    <input type="checkbox" id="peripheral-smartport" class="peripheral-checkbox">
                                    SmartPort Telemetry
                                </label>
                                <select id="smartport-uart-select" class="hw-input peripheral-uart">
                                    <option value="UART4" selected>UART4</option>
                                    <option value="UART1">UART1</option>
                                    <option value="UART2">UART2</option>
                                    <option value="UART3">UART3</option>
                                    <option value="UART5">UART5</option>
                                    <option value="UART6">UART6</option>
                                </select>
                            </div>
                            
                            <div class="config-item">
                                <label>
                                    <input type="checkbox" id="peripheral-gimbal" class="peripheral-checkbox">
                                    Gimbal Control
                                </label>
                                <select id="gimbal-uart-select" class="hw-input peripheral-uart">
                                    <option value="UART3" selected>UART3</option>
                                    <option value="UART1">UART1</option>
                                    <option value="UART2">UART2</option>
                                    <option value="UART4">UART4</option>
                                    <option value="UART5">UART5</option>
                                    <option value="UART6">UART6</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="config-item full-width">
                        <label for="notes-input">Catatan Tambahan:</label>
                        <textarea id="notes-input" class="hw-input" rows="3" 
                                  placeholder="Catatan khusus tentang setup Anda..."></textarea>
                    </div>
                </div>

                <div class="info-card">
                    <h3>üìã Ringkasan Konfigurasi Anda</h3>
                    <div id="hardware-summary" class="spec-list">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <div class="resource-links">
                    <h3>üìö Dokumentasi Referensi</h3>
                    <div id="reference-links">
                        <!-- Will be populated dynamically based on hardware -->
                        <a href="https://www.speedybee.com/speedybee-f405-v4-bls-55a-30x30-fc-esc-stack/" target="_blank" class="link-btn">Product Website</a>
                        <a href="https://store-fhxxhuiq8q.mybigcommerce.com/product_images/img_SpeedyBee_F405_V4_Stack/SpeedyBee_F405_V4_Stack_Manual_EN.pdf" target="_blank" class="link-btn">User Manual</a>
                        <a href="https://ardupilot.org/copter/docs/common-speedybeef4-v3.html" target="_blank" class="link-btn">ArduPilot Docs</a>
                    </div>
                </div>
            </section>

            <!-- Step 1: Frame Type -->
            <section class="step-content" id="step1" style="display:none;">
                <h2>1. Set Frame Type</h2>
                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>Konfigurasi Frame Dinamis</h3>
                        <div id="frame-config-display">
                            <!-- Will be populated by JavaScript based on hardware config -->
                        </div>
                        
                        <div class="param-list">
                            <div class="param-item" id="frame-class-param">
                                <code>FRAME_CLASS = ?</code>
                                <span>Frame class parameter</span>
                            </div>
                            <div class="param-item" id="frame-type-param">
                                <code>FRAME_TYPE = ?</code>
                                <span>Frame type parameter</span>
                            </div>
                        </div>
                        
                        <div class="alert alert-info">
                            <strong>üí° Tips:</strong> Parameter frame type sudah diset berdasarkan konfigurasi hardware Anda di langkah pertama. 
                            Jika ingin mengubah, kembali ke langkah "Konfigurasi Hardware".
                        </div>
                    </div>
                    <div id="frame-diagram">
                        <img src="../ardupilot/nazgul/img/01-frame-type.png" alt="Frame Type Configuration" class="instruction-img">
                    </div>
                </div>
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" class="step-check" data-step="1">
                        <span id="frame-check-text">Frame type sudah dikonfigurasi</span>
                    </label>
                </div>
            </section>

            <!-- Step 2: Initial Tune -->
            <section class="step-content" id="step2" style="display:none;">
                <h2>2. Initial Tune</h2>
                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>Konfigurasi Baterai</h3>
                        <ul>
                            <li>Baterai: <strong>6S</strong></li>
                            <li>Max Voltage: <strong>4.2 volt</strong></li>
                            <li>Min Voltage: <strong>3.3 volt</strong></li>
                        </ul>
                        <div class="alert alert-warning">
                            <strong>‚ö†Ô∏è Penting:</strong> Setting voltage yang tepat sangat penting untuk keamanan baterai
                        </div>
                    </div>
                    <img src="../ardupilot/nazgul/img/02-initial-tune.png" alt="Initial Tune Configuration" class="instruction-img">
                </div>
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" class="step-check" data-step="2">
                        <span>Parameter baterai sudah dikonfigurasi</span>
                    </label>
                </div>
            </section>

            <!-- Step 3: Flight Controller Orientation -->
            <section class="step-content" id="step3" style="display:none;">
                <h2>3. Orientasi Flight Controller</h2>
                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>üìê Pilih Orientasi Flight Controller</h3>
                        
                        <div class="fc-orientation-selection">
                            <h4>Orientasi FC Anda:</h4>
                            <select id="fc-orientation-select" class="hw-input">
                                <option value="0">Normal - Panah/USB menghadap ke depan</option>
                                <option value="1">Yaw 90¬∞ - Diputar 90¬∞ searah jarum jam</option>
                                <option value="2">Yaw 180¬∞ - Diputar 180¬∞ (terbalik)</option>
                                <option value="3">Yaw 270¬∞ - Diputar 270¬∞ searah jarum jam</option>
                                <option value="4">Roll 180¬∞ - Terbalik horizontal (upside down)</option>
                                <option value="5">Roll 180¬∞ + Yaw 90¬∞ - Terbalik + putar 90¬∞</option>
                                <option value="8">Pitch 180¬∞ - Terbalik vertikal</option>
                                <option value="12">Yaw 90¬∞ + Roll 180¬∞ - Putar 90¬∞ + terbalik horizontal</option>
                                <option value="13">Yaw 180¬∞ + Roll 180¬∞ - Putar 180¬∞ + terbalik horizontal</option>
                                <option value="14">Yaw 270¬∞ + Roll 180¬∞ - Putar 270¬∞ + terbalik horizontal</option>
                                <option value="20">Pitch 90¬∞ - Hidung naik 90¬∞</option>
                                <option value="21">Pitch 270¬∞ - Hidung turun 90¬∞</option>
                            </select>
                        </div>
                        
                        <div id="fc-orientation-display">
                            <!-- Will be populated by JavaScript -->
                        </div>

                        <div class="highlight-box">
                            <h4>üí° Tips Memilih Orientasi:</h4>
                            <ul>
                                <li><strong>Normal (0)</strong>: Orientasi paling umum - panah FC menghadap depan drone</li>
                                <li><strong>Yaw rotations</strong>: Untuk FC yang diputar secara horizontal</li>
                                <li><strong>Roll 180¬∞</strong>: Untuk FC yang dipasang terbalik (upside down)</li>
                                <li><strong>Pitch rotations</strong>: Untuk FC yang dipasang miring ke atas/bawah</li>
                            </ul>
                        </div>

                        <div class="orientation-table">
                            <h4>Orientasi Non-Standar:</h4>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Value</th>
                                        <th>Orientasi</th>
                                        <th>Deskripsi</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>0</td>
                                        <td>None</td>
                                        <td>Normal - panah/USB ke depan</td>
                                    </tr>
                                    <tr>
                                        <td>1</td>
                                        <td>Yaw 90</td>
                                        <td>Diputar 90¬∞ searah jarum jam</td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>Yaw 180</td>
                                        <td>Diputar 180¬∞ (terbalik)</td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>Yaw 270</td>
                                        <td>Diputar 270¬∞ searah jarum jam</td>
                                    </tr>
                                    <tr>
                                        <td>4</td>
                                        <td>Roll 180</td>
                                        <td>Terbalik horizontal (upside down)</td>
                                    </tr>
                                    <tr>
                                        <td>5</td>
                                        <td>Roll 180 Yaw 90</td>
                                        <td>Terbalik + putar 90¬∞</td>
                                    </tr>
                                    <tr>
                                        <td>8</td>
                                        <td>Pitch 180</td>
                                        <td>Terbalik vertikal</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="verification-section">
                            <h4>üîç Verifikasi Orientasi FC:</h4>
                            
                            <div class="method-box">
                                <h5>Method 1: HUD Display</h5>
                                <ol>
                                    <li>Buka Mission Planner ‚Üí Flight Data</li>
                                    <li>Lihat HUD (Horizon Display)</li>
                                    <li>Miringkan drone ke kanan ‚Üí HUD harus menunjukkan roll ke kanan</li>
                                    <li>Naikkan hidung drone ‚Üí HUD harus menunjukkan pitch up</li>
                                    <li>Putar drone ke kiri ‚Üí HUD compass harus berputar ke kiri</li>
                                </ol>
                            </div>

                            <div class="method-box">
                                <h5>Method 2: Raw IMU Data</h5>
                                <ol>
                                    <li>Buka Flight Data ‚Üí Status tab</li>
                                    <li>Lihat nilai AccX, AccY, AccZ</li>
                                    <li>Drone horizontal: AccZ ‚âà -10 (gravitasi)</li>
                                    <li>Miringkan kanan: AccY positif</li>
                                    <li>Naikkan hidung: AccX negatif</li>
                                </ol>
                            </div>

                            <div class="method-box">
                                <h5>Method 3: Compass Heading</h5>
                                <ol>
                                    <li>Lihat compass heading di Mission Planner</li>
                                    <li>Arahkan nose drone ke Utara</li>
                                    <li>Heading harus menunjukkan ‚âà 0¬∞ atau 360¬∞</li>
                                    <li>Putar drone searah jarum jam</li>
                                    <li>Heading harus bertambah (90¬∞, 180¬∞, 270¬∞)</li>
                                </ol>
                            </div>
                        </div>

                        <div class="troubleshooting-section">
                            <h4>üõ†Ô∏è Troubleshooting Orientasi Salah:</h4>
                            
                            <div class="problem-solution">
                                <h5>Problem: HUD terbalik atau bergerak berlawanan</h5>
                                <p><strong>Solution:</strong></p>
                                <ul>
                                    <li>Cek pemasangan fisik FC</li>
                                    <li>Sesuaikan AHRS_ORIENTATION sesuai tabel</li>
                                    <li>Restart FC dan re-test</li>
                                </ul>
                            </div>

                            <div class="problem-solution">
                                <h5>Problem: Compass heading tidak akurat</h5>
                                <p><strong>Solution:</strong></p>
                                <ul>
                                    <li>Calibrasi compass (langkah terpisah)</li>
                                    <li>Cek interferensi magnetic</li>
                                    <li>Pastikan COMPASS_ORIENT sesuai dengan FC orientation</li>
                                </ul>
                            </div>
                        </div>

                        <div class="alert alert-warning">
                            <strong>‚ö†Ô∏è Penting:</strong> Orientasi yang salah dapat menyebabkan drone crash! Selalu verifikasi dengan teliti sebelum flight test.
                        </div>

                        <div class="alert alert-info">
                            <strong>üí° Tip:</strong> Jika menggunakan mounting non-standar, buat catatan orientasi untuk referensi future maintenance.
                        </div>
                    </div>
                </div>
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" class="step-check" data-step="3">
                        <span id="fc-orientation-check-text">Orientasi flight controller sudah dikonfigurasi dan diverifikasi</span>
                    </label>
                </div>
            </section>

            <!-- Step 4: Serial Ports -->
            <section class="step-content" id="step4" style="display:none;">
                <h2>4. Konfigurasi Serial Port</h2>
                
                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>üîå Konfigurasi UART Anda</h3>
                        <p>Berdasarkan peripheral yang Anda pilih di konfigurasi hardware:</p>
                        
                        <div id="dynamic-serial-table">
                            <!-- Will be populated dynamically by JavaScript -->
                        </div>
                        
                        <div class="alert alert-info">
                            <strong>üí° Tips:</strong> Konfigurasi ini dibuat otomatis berdasarkan peripheral yang Anda aktifkan di langkah pertama. 
                            Untuk mengubah, kembali ke "Konfigurasi Hardware".
                        </div>
                    </div>
                </div>

                <div class="instruction-card" id="wiring-instructions">
                    <!-- Will be populated dynamically with wiring instructions -->
                </div>
                
                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>üìù Cara Setting di Mission Planner</h3>
                        <ol>
                            <li>Buka <strong>Config > Full Parameter List</strong></li>
                            <li>Cari parameter <strong>SERIAL</strong> yang sesuai dengan tabel di atas</li>
                            <li>Set <strong>PROTOCOL</strong> dan <strong>BAUD</strong> sesuai dengan nilai yang ditampilkan</li>
                            <li>Klik <strong>Write Params</strong> untuk menyimpan</li>
                            <li>Reboot flight controller</li>
                        </ol>
                        
                        <div class="alert alert-warning">
                            <strong>‚ö†Ô∏è Penting:</strong> Pastikan koneksi fisik sudah benar sebelum mengaktifkan protokol serial.
                        </div>
                    </div>
                    <img src="../ardupilot/nazgul/img/04-serial-ports.png" alt="Serial Ports Configuration" class="instruction-img">
                </div>

                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" class="step-check" data-step="4">
                        <span id="serial-check-text">Serial port sudah dikonfigurasi</span>
                    </label>
                </div>
            </section>

            <!-- Step 5: ESC Configuration -->
            <section class="step-content" id="step5" style="display:none;">
                <h2>5. Konfigurasi ESC</h2>
                
                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>üì° Pilih Jenis ESC Protocol</h3>
                        
                        <div class="esc-selection">
                            <h4>Jenis ESC Protocol:</h4>
                            <select id="esc-protocol-select" class="hw-input">
                                <option value="dshot300">DShot300 (Recommended)</option>
                                <option value="dshot600">DShot600 (High Performance)</option>
                                <option value="dshot1200">DShot1200 (Ultra High Performance)</option>
                                <option value="pwm">PWM (Legacy/Budget ESCs)</option>
                                <option value="oneshot125">OneShot125 (Legacy High Performance)</option>
                                <option value="oneshot42">OneShot42 (Legacy Ultra)</option>
                                <option value="multishot">Multishot (Legacy Racing)</option>
                            </select>
                        </div>
                        
                        <div id="esc-config-display">
                            <!-- Will be populated by JavaScript -->
                        </div>
                        
                        <div class="highlight-box">
                            <h4>üí° Rekomendasi Protocol:</h4>
                            <ul>
                                <li><strong>DShot300</strong>: Optimal untuk sebagian besar setup (konsumsi daya rendah)</li>
                                <li><strong>DShot600</strong>: Untuk racing dan performance tinggi</li>
                                <li><strong>DShot1200</strong>: Untuk ultra-high performance (butuh FC powerful)</li>
                                <li><strong>PWM</strong>: Untuk ESC lama yang tidak support DShot</li>
                            </ul>
                        </div>
                        
                        <div class="alert alert-info">
                            <strong>üîß Tips ESC:</strong> 
                            <ul>
                                <li>DShot protocol memberikan kontrol yang lebih presisi daripada PWM</li>
                                <li>DShot300 adalah pilihan terbaik untuk balance antara performance dan reliability</li>
                                <li>Pastikan semua ESC mendukung protocol yang dipilih</li>
                                <li>DShot juga mendukung bidirectional untuk RPM telemetry</li>
                            </ul>
                        </div>
                        
                        <div class="param-section">
                            <h4>üìã Parameter yang akan diset:</h4>
                            <div id="esc-params-display">
                                <!-- Will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" class="step-check" data-step="5">
                        <span id="esc-check-text">Protocol ESC sudah dikonfigurasi</span>
                    </label>
                </div>
            </section>

            <!-- Step 6: Motor Test -->
            <section class="step-content" id="step6" style="display:none;">
                <h2>6. Motor Test & RPM Balance Check</h2>
                
                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>üöÅ Persiapan Motor Test</h3>
                        <div class="alert alert-danger">
                            <strong>‚ö†Ô∏è SAFETY FIRST:</strong> 
                            <ul>
                                <li><strong>WAJIB lepas semua propeller</strong> sebelum test motor</li>
                                <li>Pastikan drone terpasang aman di bench/mounting</li>
                                <li>Siapkan ruang yang cukup untuk keamanan</li>
                                <li>Matikan VTX untuk menghindari overheat (tidak ada airflow)</li>
                            </ul>
                        </div>
                        
                        <h4>üìã Checklist Pre-Test:</h4>
                        <ul>
                            <li>‚òëÔ∏è Propeller sudah dilepas semua</li>
                            <li>‚òëÔ∏è Baterai terpasang dan terisi penuh</li>
                            <li>‚òëÔ∏è FC terhubung ke Mission Planner</li>
                            <li>‚òëÔ∏è ESC sudah dikalibrasi (jika perlu)</li>
                            <li>‚òëÔ∏è Area test aman dan cukup luas</li>
                        </ul>
                    </div>
                </div>

                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>üîß Langkah Motor Test</h3>
                        
                        <h4>Step 1: Basic Motor Function Test</h4>
                        <ol>
                            <li>Buka <strong>Setup > Optional Hardware > Motor Test</strong></li>
                            <li>Set throttle ke <strong>5-10%</strong> untuk test awal</li>
                            <li>Test setiap motor dengan tombol <strong>Test Motor A, B, C, D</strong></li>
                            <li>Verifikasi semua motor berputar dan tidak ada yang macet</li>
                            <li>Cek tidak ada getaran berlebih atau suara abnormal</li>
                        </ol>
                        
                        <h4>Step 2: RPM Balance Test</h4>
                        <ol>
                            <li>Naikkan throttle ke <strong>25-30%</strong></li>
                            <li>Test motor satu per satu dengan durasi <strong>5-10 detik</strong></li>
                            <li>Perhatikan dan catat RPM setiap motor (jika tersedia)</li>
                            <li>Dengarkan pitch sound dari setiap motor</li>
                            <li>Motor yang seimbang akan memiliki sound pitch yang sama</li>
                        </ol>
                        
                        <h4>Step 3: Visual & Audio Assessment</h4>
                        <table class="config-table">
                            <thead>
                                <tr>
                                    <th>Parameter</th>
                                    <th>Normal</th>
                                    <th>Abnormal</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Sound</strong></td>
                                    <td>‚úÖ Smooth, pitch sama</td>
                                    <td>‚ùå Kasar, pitch beda</td>
                                    <td>Cek bearing motor</td>
                                </tr>
                                <tr>
                                    <td><strong>Vibration</strong></td>
                                    <td>‚úÖ Minimal vibration</td>
                                    <td>‚ùå Getaran berlebih</td>
                                    <td>Balance motor/prop</td>
                                </tr>
                                <tr>
                                    <td><strong>Startup</strong></td>
                                    <td>‚úÖ Smooth start</td>
                                    <td>‚ùå Jerky/hesitant</td>
                                    <td>Kalibrasi ESC</td>
                                </tr>
                                <tr>
                                    <td><strong>Temperature</strong></td>
                                    <td>‚úÖ Cool/warm</td>
                                    <td>‚ùå Hot to touch</td>
                                    <td>Cek motor/ESC</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>üìä RPM Balance Analysis</h3>
                        
                        <h4>üéØ Target RPM Balance:</h4>
                        <div class="highlight-box">
                            <ul>
                                <li><strong>Excellent</strong>: RPM difference ‚â§ 2% antar motor</li>
                                <li><strong>Good</strong>: RPM difference ‚â§ 5% antar motor</li>
                                <li><strong>Acceptable</strong>: RPM difference ‚â§ 8% antar motor</li>
                                <li><strong>Poor</strong>: RPM difference > 8% (perlu perbaikan)</li>
                            </ul>
                        </div>
                        
                        <h4>üîç Cara Mengecek RPM Balance:</h4>
                        <ol>
                            <li><strong>Metode 1 - Sound Pitch</strong>:
                                <ul>
                                    <li>Test setiap motor di throttle yang sama (25-30%)</li>
                                    <li>Dengarkan pitch/nada suara motor</li>
                                    <li>Motor yang RPM-nya sama akan punya pitch yang identik</li>
                                    <li>Gunakan tuner app di HP untuk mengukur frequency</li>
                                </ul>
                            </li>
                            <li><strong>Metode 2 - Visual Observation</strong>:
                                <ul>
                                    <li>Lihat kecepatan putaran motor secara visual</li>
                                    <li>Motor yang balance akan terlihat berputar dengan kecepatan sama</li>
                                    <li>Gunakan smartphone camera dengan slow motion jika perlu</li>
                                </ul>
                            </li>
                            <li><strong>Metode 3 - ESC Telemetry (jika ada)</strong>:
                                <ul>
                                    <li>Gunakan ESC dengan telemetry untuk monitoring RPM real-time</li>
                                    <li>Baca data RPM dari Mission Planner atau OSD</li>
                                    <li>Catat dan bandingkan RPM setiap motor</li>
                                </ul>
                            </li>
                        </ol>
                        
                        <h4>üõ†Ô∏è Troubleshooting RPM Imbalance Checklist:</h4>
                        <div class="troubleshooting-checklist">
                            <h5>Jika RPM tidak seimbang, lakukan pemeriksaan berikut:</h5>
                            <div class="checklist-grid">
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="troubleshoot-check">
                                        <strong>Cek propeller balance</strong> (jika terpasang saat test)
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="troubleshoot-check">
                                        <strong>Kalibrasi ESC</strong> - pastikan semua ESC terkalibrasi sama
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="troubleshoot-check">
                                        <strong>Cek motor bearing</strong> - ganti jika ada yang kasar
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="troubleshoot-check">
                                        <strong>Verifikasi motor KV</strong> - pastikan semua motor sama KV
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="troubleshoot-check">
                                        <strong>Cek wiring</strong> - pastikan tidak ada voltage drop
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="troubleshoot-check">
                                        <strong>Cek solderan motor</strong> - pastikan tidak ada serabut yang kontak dengan pad di sebelahnya
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="troubleshoot-check">
                                        <strong>Cek kabel motor</strong> - pastikan tidak ada yang terkupas dan menyentuh arm/frame
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="troubleshoot-check">
                                        <strong>Cek baut motor</strong> - pastikan tidak ada yang menyentuh gulungan
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="troubleshoot-check">
                                        <strong>Test dengan propeller berbeda</strong> untuk isolasi masalah
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>üìù Motor Test Checklist</h3>
                        <div class="motor-test-checklist">
                            <h4>‚úÖ Pre-Flight Motor Test Results:</h4>
                            <div class="checklist-grid">
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="motor-item-check">
                                        Motor A - RPM normal & smooth
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="motor-item-check">
                                        Motor B - RPM normal & smooth
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="motor-item-check">
                                        Motor C - RPM normal & smooth
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="motor-item-check">
                                        Motor D - RPM normal & smooth
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="motor-item-check">
                                        Semua motor sound pitch sama
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="motor-item-check">
                                        Tidak ada getaran abnormal
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="motor-item-check">
                                        Tidak ada motor yang overheat
                                    </label>
                                </div>
                                <div class="checklist-item">
                                    <label>
                                        <input type="checkbox" class="motor-item-check">
                                        RPM balance dalam range yang dapat diterima (‚â§8%)
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="alert alert-success" style="margin-top: 20px;">
                            <strong>üí° Pro Tip:</strong> Motor test yang bagus adalah fondasi untuk flight performance yang optimal. 
                            Jangan skip step ini - motor yang tidak balance akan menyebabkan vibration dan mengurangi flight time!
                        </div>
                    </div>
                </div>
                
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" class="step-check" data-step="6">
                        <span>Motor test lengkap sudah dilakukan, RPM balance verified, semua motor normal</span>
                    </label>
                </div>
            </section>

            <!-- Step 7: Motor Order/Servo Output -->
            <section class="step-content" id="step7" style="display:none;">
                <h2>7. Motor Order & Servo Output Mapping</h2>
                
                <div class="motor-setup-section" id="motor-config-section">
                    <!-- Will be populated dynamically by JavaScript -->
                </div>

                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>üîß Servo Output Mapping & Motor Direction</h3>
                        <p>Sekarang setelah motor test berhasil, kita perlu memverifikasi mapping motor dan arah putaran sesuai frame type.</p>
                        
                        <div class="alert alert-info">
                            <strong>üí° Info:</strong> Motor test basic sudah dilakukan di step 6. Sekarang kita fokus pada mapping dan direction verification.
                        </div>
                    </div>
                </div>

                <div class="step-by-step">
                    <h4>Langkah 1: Verifikasi Motor Mapping</h4>
                    <p>Pastikan setiap servo output channel terhubung ke motor yang benar:</p>
                    
                    <table class="motor-table" id="dynamic-motor-test-table">
                        <!-- Will be populated dynamically by JavaScript -->
                    </table>
                </div>

                <div class="step-by-step" id="servo-output-config">
                    <!-- Will be populated dynamically if servo mapping exists -->
                </div>

                <div class="step-by-step">
                    <h4>Langkah 2: Verifikasi Arah Putaran Motor</h4>
                    <ol>
                        <li>Gunakan hasil dari motor test di step 6</li>
                        <li>Pastikan arah putaran sesuai dengan frame type</li>
                        <li>Cek tabel referensi frame type untuk arah putaran yang benar</li>
                        <li>Jika ada motor yang arahnya salah, lakukan koreksi</li>
                    </ol>
                </div>

                <div class="step-by-step">
                    <h4>Langkah 3: Koreksi Arah Putaran (Jika Diperlukan)</h4>
                    <p>Jika arah putaran motor tidak sesuai dengan tabel referensi:</p>
                    
                    <div class="alert alert-warning">
                        <strong>‚ö†Ô∏è Penting:</strong> Arah putaran harus sesuai dengan frame type untuk flight stability!
                    </div>
                    
                    <p>Cara mengubah arah putaran menggunakan parameter <strong>SERVO_BLH_RVMASK</strong>:</p>
                    <ol>
                        <li>Buka <strong>Config > Full Parameter List</strong></li>
                        <li>Cari parameter <strong>SERVO_BLH_RVMASK</strong></li>
                        <li>Centang channel motor yang ingin dibalik arah putarannya</li>
                        <li>Write parameters dan test ulang untuk verifikasi</li>
                    </ol>
                    
                    <img src="../ardupilot/nazgul/img/servo-blh-reverse.png" alt="Servo BLH Reverse" class="instruction-img">
                </div>

                <div class="step-by-step">
                    <h4>Langkah 4: Final Verification</h4>
                    <p>Setelah semua mapping dan direction sudah benar:</p>
                    <ol>
                        <li>Lakukan motor test ulang dengan throttle rendah (5-10%)</li>
                        <li>Verifikasi urutan: Motor A, B, C, D sesuai posisi frame</li>
                        <li>Verifikasi arah putaran sesuai dengan frame type</li>
                        <li>Pastikan tidak ada motor yang berputar terbalik</li>
                    </ol>
                    
                    <div class="alert alert-success">
                        <strong>‚úÖ Success:</strong> Semua motor sudah ter-mapping dengan benar dan arah putaran sesuai frame type!
                    </div>
                </div>

                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" class="step-check" data-step="7">
                        <span id="motor-check-text">Motor mapping dan arah putaran sudah diverifikasi dan sesuai dengan frame type</span>
                    </label>
            </section>

            <!-- Step 8: Flight Modes -->
            <section class="step-content" id="step8" style="display:none;">
                <h2>8. Set Flight Modes</h2>
                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>Mode Terbang</h3>
                        <table class="config-table">
                            <thead>
                                <tr>
                                    <th>Mode</th>
                                    <th>Fungsi</th>
                                    <th>Deskripsi</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>Stabilize</td>
                                    <td>Manual flight dengan stabilisasi otomatis. Drone akan self-level saat stick dilepas.</td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>Acro</td>
                                    <td>Mode acrobatic tanpa stabilisasi. Full manual control untuk freestyle/aerobatic.</td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>Loiter</td>
                                    <td>GPS hold position. Drone hover di satu titik menggunakan GPS untuk positioning.</td>
                                </tr>
                                <tr>
                                    <td>4</td>
                                    <td>Auto / Mission</td>
                                    <td>Autonomous flight mengikuti waypoint mission yang sudah diprogram.</td>
                                </tr>
                                <tr>
                                    <td>5</td>
                                    <td>Guided</td>
                                    <td>Remote guided flight. Drone mengikuti perintah dari ground control station.</td>
                                </tr>
                                <tr>
                                    <td>6</td>
                                    <td>Return to Launch</td>
                                    <td>Otomatis kembali ke titik takeoff dan landing dengan GPS guidance.</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="param-box">
                            <strong>Parameter:</strong> FLTMODE_CH = 7 (Channel 7)
                        </div>
                    </div>
                    <img src="../ardupilot/nazgul/img/06-flight-modes.png" alt="Flight Modes Configuration" class="instruction-img">
                </div>
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" class="step-check" data-step="8">
                        <span>Flight modes sudah dikonfigurasi</span>
                    </label>
            </section>

            <!-- Step 9: Arming Configuration -->
            <section class="step-content" id="step9" style="display:none;">
                <h2>9. Set Arming Channel</h2>
                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>üîß Cara Setting Switch Arming/Disarm</h3>
                        
                        <h4>Step 1: Konfigurasi Channel Arming</h4>
                        <p>Pilih channel AUX untuk arming switch (biasanya AUX1/Channel 5):</p>
                        <div class="param-list">
                            <div class="param-item">
                                <code>RC5_OPTION = 154</code>
                                <span>Channel 5 (AUX1) untuk Arm/Disarm</span>
                            </div>
                            <div class="param-item">
                                <code>ARMING_RUDDER = 0</code>
                                <span>Disable arming dengan stik command</span>
                            </div>
                        </div>
                        
                        <h4>Step 2: Setup Switch di Radio</h4>
                        <ol>
                            <li><strong>Pilih switch 2-posisi</strong> untuk arming (contoh: SA, SB, atau SC)</li>
                            <li><strong>Assign ke channel AUX1</strong> di mixer radio</li>
                            <li><strong>Set nilai switch</strong>:
                                <ul>
                                    <li>Position UP (DISARM) = ~1000Œºs</li>
                                    <li>Position DOWN (ARM) = ~2000Œºs</li>
                                </ul>
                            </li>
                            <li><strong>Test di Mission Planner</strong>: Radio Calibration untuk verifikasi channel value</li>
                        </ol>
                        
                        <h4>Step 3: Test Switch Functionality</h4>
                        <div class="highlight-box">
                            <h5>üö® CRITICAL SAFETY TEST:</h5>
                            <ol>
                                <li><strong>Switch DISARM harus berfungsi</strong> - pastikan drone bisa disarm kapan saja</li>
                                <li><strong>Test emergency disarm</strong> - coba disarm saat motor berputar (motor test)</li>
                                <li><strong>Verifikasi switch direction</strong> - pastikan arah switch sesuai logika (UP=DISARM, DOWN=ARM)</li>
                                <li><strong>Test arming sequence</strong> - coba arm/disarm beberapa kali</li>
                            </ol>
                        </div>
                        
                        <div class="alert alert-danger">
                            <strong>‚õî DILARANG TAKEOFF</strong> sebelum switch disarm berfungsi dengan sempurna!<br>
                            Switch disarm adalah safety feature utama untuk emergency situation.
                        </div>
                    </div>
                </div>

                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>üõ°Ô∏è Safety Checklist Arming</h3>
                        
                        <div class="checklist-grid">
                            <div class="checklist-item">
                                <label>
                                    <input type="checkbox" class="arming-safety-check">
                                    <strong>Switch arming response test</strong> - switch berfungsi dengan baik
                                </label>
                            </div>
                            <div class="checklist-item">
                                <label>
                                    <input type="checkbox" class="arming-safety-check">
                                    <strong>Emergency disarm test</strong> - bisa disarm kapan saja
                                </label>
                            </div>
                            <div class="checklist-item">
                                <label>
                                    <input type="checkbox" class="arming-safety-check">
                                    <strong>Switch direction correct</strong> - UP=DISARM, DOWN=ARM
                                </label>
                            </div>
                            <div class="checklist-item">
                                <label>
                                    <input type="checkbox" class="arming-safety-check">
                                    <strong>Radio failsafe configured</strong> - behavior saat signal loss
                                </label>
                            </div>
                            <div class="checklist-item">
                                <label>
                                    <input type="checkbox" class="arming-safety-check">
                                    <strong>Battery failsafe configured</strong> - behavior saat low voltage
                                </label>
                            </div>
                            <div class="checklist-item">
                                <label>
                                    <input type="checkbox" class="arming-safety-check">
                                    <strong>Arming checks enabled</strong> - ARMING_CHECK = 1 (ALL)
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" class="step-check" data-step="9">
                        <span>Switch arming/disarm sudah dikonfigurasi dan safety test selesai</span>
                    </label>
                </div>
            </section>

            <!-- Step 10: Autotune -->
            <section class="step-content" id="step10" style="display:none;">
                <h2>10. Set Autotune Channel</h2>
                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>üîß Setup Switch Autotune</h3>
                        
                        <h4>Step 1: Konfigurasi Channel Autotune</h4>
                        <p>Assign autotune ke switch tersendiri (jangan digabung dengan switch lain):</p>
                        <div class="param-list">
                            <div class="param-item">
                                <code>RC6_OPTION = 17</code>
                                <span>Channel 6 (AUX2) untuk Autotune</span>
                            </div>
                        </div>
                        
                        <h4>Step 2: Setup Switch di Radio</h4>
                        <ol>
                            <li><strong>Pilih switch 2-posisi terpisah</strong> khusus untuk autotune</li>
                            <li><strong>Assign ke channel AUX2</strong> (Channel 6)</li>
                            <li><strong>Set nilai switch</strong>:
                                <ul>
                                    <li>Position UP (OFF) = ~1000Œºs</li>
                                    <li>Position DOWN (ON) = ~2000Œºs</li>
                                </ul>
                            </li>
                        </ol>
                        
                        <div class="highlight-box">
                            <h4>üéØ Tips Autotune Penting:</h4>
                            <ol>
                                <li><strong>Setting autotune di switch tersendiri</strong> - jangan share dengan fungsi lain</li>
                                <li><strong>Autotune bisa diaktifkan di mode:</strong>
                                    <ul>
                                        <li>‚úÖ <strong>Stabilize</strong> (DIREKOMENDASIKAN)</li>
                                        <li>‚úÖ Alt-Hold</li>
                                        <li>‚úÖ Loiter</li>
                                    </ul>
                                </li>
                                <li><strong>Rekomendasi: Start autotune dari mode Stabilize</strong> untuk hasil optimal</li>
                                <li><strong>Pastikan baterai penuh</strong> - autotune membutuhkan waktu 10-15 menit</li>
                                <li><strong>Area terbuka minimal 20x20 meter</strong> untuk pergerakan autotune</li>
                                <li><strong>Cuaca tenang</strong> - hindari angin kencang saat autotune</li>
                            </ol>
                        </div>
                        
                        <div class="alert alert-warning">
                            <strong>‚ö†Ô∏è Catatan Penting:</strong> Autotune akan menggerakkan drone secara otomatis. 
                            Pastikan Anda siap mengambil kontrol manual jika diperlukan dengan switch arming atau mode flight.
                        </div>
                    </div>
                </div>

                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>üöÅ Proses Autotune</h3>
                        <p>Setelah hover stabil di mode Stabilize, Altitude Hold, dan Loiter:</p>
                        
                        <h4>Step 3: Parameter Autotune</h4>
                        <div class="param-list">
                            <div class="param-item">
                                <code>AUTOTUNE_AGGR = 0.1</code>
                                <span>Aggressiveness level (0.1 = conservative, 0.2 = aggressive)</span>
                            </div>
                            <div class="param-item">
                                <code>AUTOTUNE_AXES = 7</code>
                                <span>Axes to tune (1=Roll, 2=Pitch, 4=Yaw, 7=All)</span>
                            </div>
                        </div>
                        
                        <h4>Step 4: Prosedur Autotune</h4>
                        <div class="highlight-box">
                            <ol class="process-list">
                                <li><strong>Pastikan baterai penuh</strong> - autotune butuh 10-15 menit</li>
                                <li><strong>Hover di area luas dan aman</strong> - minimal 20x20 meter</li>
                                <li><strong>Takeoff dalam mode Stabilize</strong> dan hover stabil</li>
                                <li><strong>Aktifkan autotune via switch</strong> - drone akan mulai bergerak otomatis</li>
                                <li><strong>Jangan sentuh stick</strong> - biarkan autotune bekerja</li>
                                <li><strong>Tunggu sampai selesai</strong> - drone akan berhenti bergerak dan hover normal</li>
                                <li><strong>Matikan switch autotune</strong> dan land dengan aman</li>
                                <li><strong>Save parameter</strong> di Mission Planner</li>
                            </ol>
                        </div>
                        
                        <div class="alert alert-info">
                            <strong>üí° Tips Hemat Baterai:</strong> Untuk drone besar atau baterai kecil, lakukan autotune per axis: 
                            Set AUTOTUNE_AXES=1 (Roll only) ‚Üí land ‚Üí ganti baterai ‚Üí AUTOTUNE_AXES=2 (Pitch) ‚Üí dan seterusnya.
                        </div>
                        
                        <div class="alert alert-success">
                            <strong>‚úÖ Tanda Autotune Berhasil:</strong>
                            <ul>
                                <li>Drone hover lebih stabil tanpa oscillation</li>
                                <li>Response stick lebih crisp dan presisi</li>
                                <li>Parameter P, I, D sudah terupdate otomatis</li>
                                <li>Pesan "AutoTune: Success" muncul di HUD</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" class="step-check" data-step="10">
                        <span>Autotune channel diset dan proses autotune selesai</span>
                    </label>
                </div>
            </section>


            <!-- Step 11: MavLink ELRS -->
            <section class="step-content" id="step11" style="display:none;">
                <h2>11. MavLink via ELRS Backpack</h2>
                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>Konfigurasi ELRS MavLink</h3>
                        <div class="param-item">
                            <code>RSSI_TYPE = 5</code>
                            <span>Enable RSSI dari ELRS</span>
                        </div>
                        <p>Untuk koneksi laptop ke backpack remote via WiFi, gunakan protokol UDP di Mission Planner.</p>
                        <div class="resource-links">
                            <a href="https://www.expresslrs.org/software/mavlink/" target="_blank" class="link-btn">üìñ Dokumentasi ELRS</a>
                            <a href="https://www.youtube.com/watch?v=EOUdSb7iJ2s" target="_blank" class="link-btn">üì∫ Tutorial Video</a>
                        </div>
                    </div>
                    <img src="../ardupilot/nazgul/img/08-elrs-mavlink-rssi-type.png" alt="ELRS MavLink Configuration" class="instruction-img">
                </div>
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" class="step-check" data-step="11">
                        <span>MavLink ELRS sudah dikonfigurasi</span>
                    </label>
                </div>
            </section>

            <!-- Step 12: VTX/OSD -->
            <section class="step-content" id="step12" style="display:none;">
                <h2>12. Setup VTX/OSD</h2>
                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>Parameter VTX/OSD</h3>
                        <div class="param-list">
                            <div class="param-item">
                                <code>OSD_TYPE = 5</code>
                                <span>MSP_DISPLAYPORT</span>
                            </div>
                            <div class="param-item">
                                <code>OSD_CELL_COUNT = 4</code>
                                <span>Jumlah cell baterai</span>
                            </div>
                            <div class="param-item">
                                <code>MSP_OPTIONS = 0</code>
                                <span>Disable telemetry mode</span>
                            </div>
                            <div class="param-item">
                                <code>SERIAL1_PROTOCOL = 42</code>
                                <span>DisplayPort protocol</span>
                            </div>
                            <div class="param-item">
                                <code>SERIAL1_BAUD = 115</code>
                                <span>Baud rate 115200</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" class="step-check" data-step="12">
                        <span>VTX/OSD sudah dikonfigurasi</span>
                    </label>
                </div>
            </section>

            <!-- Step 13: Failsafe Configuration -->
            <section class="step-content" id="step13" style="display:none;">
                <h2>13. Konfigurasi Failsafe</h2>
                <div class="instruction-card">
                    <div class="instruction-content">
                        <p>Failsafe adalah sistem keamanan otomatis yang mengambil kontrol drone ketika terjadi masalah. ArduPilot memiliki 3 jenis failsafe utama:</p>
                        
                        <h3>üîã Battery Failsafe</h3>
                        <p>Melindungi drone dari kerusakan akibat undervoltage dan memastikan cukup daya untuk landing aman.</p>
                        
                        <h4>Battery Failsafe Actions:</h4>
                        <table class="config-table">
                            <thead>
                                <tr>
                                    <th>Nilai</th>
                                    <th>Action</th>
                                    <th>Deskripsi</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>0</td><td>None</td><td>‚ùå Tidak ada tindakan (TIDAK AMAN)</td></tr>
                                <tr><td>1</td><td>Land</td><td>üõ¨ Landing di tempat saat ini (DIREKOMENDASIKAN)</td></tr>
                                <tr><td>2</td><td>RTL</td><td>üè† Return to Launch dan landing</td></tr>
                                <tr><td>3</td><td>SmartRTL</td><td>üß≠ Smart Return (ikuti jalur terbang kembali)</td></tr>
                                <tr><td>4</td><td>SmartRTL or Land</td><td>üß≠üõ¨ Smart RTL jika memungkinkan, atau Land</td></tr>
                                <tr><td>5</td><td>Terminate</td><td>‚ö†Ô∏è Matikan motor langsung (BERBAHAYA!)</td></tr>
                            </tbody>
                        </table>
                        
                        <div class="param-list">
                            <div class="param-item">
                                <code>BATT_FS_CRT_ACT = 1</code>
                                <span>Critical battery action: Land immediately</span>
                            </div>
                            <div class="param-item">
                                <code>BATT_FS_LOW_ACT = 2</code>
                                <span>Low battery action: Return to Launch</span>
                            </div>
                            <div class="param-item">
                                <code>BATT_ARM_VOLT = 22.1</code>
                                <span>Minimum voltage untuk arming (6S: 22.1V)</span>
                            </div>
                            <div class="param-item">
                                <code>BATT_CRT_VOLT = 21.0</code>
                                <span>Critical voltage trigger (6S: 21.0V)</span>
                            </div>
                            <div class="param-item">
                                <code>BATT_LOW_VOLT = 21.6</code>
                                <span>Low voltage warning (6S: 21.6V)</span>
                            </div>
                        </div>
                        
                        <h3>üì° RC Failsafe (Radio Control)</h3>
                        <p>Mengontrol drone ketika koneksi radio terputus atau signal lemah.</p>
                        
                        <h4>RC Failsafe Actions:</h4>
                        <table class="config-table">
                            <thead>
                                <tr>
                                    <th>Nilai</th>
                                    <th>Action</th>
                                    <th>Deskripsi</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>0</td><td>None</td><td>‚ùå Continue dengan last command (BERBAHAYA)</td></tr>
                                <tr><td>1</td><td>Land</td><td>üõ¨ Landing di tempat saat ini</td></tr>
                                <tr><td>2</td><td>RTL</td><td>üè† Return to Launch (DIREKOMENDASIKAN)</td></tr>
                                <tr><td>3</td><td>SmartRTL</td><td>üß≠ Smart Return to Launch</td></tr>
                                <tr><td>4</td><td>SmartRTL or Land</td><td>üß≠üõ¨ Smart RTL atau Land jika tidak bisa</td></tr>
                                <tr><td>5</td><td>Terminate</td><td>‚ö†Ô∏è Matikan motor (HANYA untuk emergency)</td></tr>
                            </tbody>
                        </table>
                        
                        <div class="param-list">
                            <div class="param-item">
                                <code>FS_THR_ENABLE = 1</code>
                                <span>Enable throttle failsafe</span>
                            </div>
                            <div class="param-item">
                                <code>FS_THR_VALUE = 975</code>
                                <span>Throttle failsafe PWM value</span>
                            </div>
                            <div class="param-item">
                                <code>RC_FS_TIMEOUT = 2</code>
                                <span>RC timeout dalam detik</span>
                            </div>
                            <div class="param-item">
                                <code>FS_OPTIONS = 0</code>
                                <span>Failsafe options (advanced)</span>
                            </div>
                        </div>
                        
                        <h3>üíª GCS Failsafe (Ground Control Station)</h3>
                        <p>Backup failsafe ketika koneksi telemetry dengan ground station terputus.</p>
                        
                        <div class="param-list">
                            <div class="param-item">
                                <code>FS_GCS_ENABLE = 1</code>
                                <span>Enable GCS failsafe</span>
                            </div>
                            <div class="param-item">
                                <code>FS_TIMEOUT = 5</code>
                                <span>GCS timeout dalam detik</span>
                            </div>
                        </div>
                        
                        <div class="highlight-box">
                            <h4>üîç Perbedaan RTL vs SmartRTL:</h4>
                            
                            <h5>üè† RTL (Return to Launch) - Traditional:</h5>
                            <ul>
                                <li>üìç Terbang langsung ke Home position dalam garis lurus</li>
                                <li>üìè Menggunakan jarak terdekat (straight line)</li>
                                <li>üåä Bisa melewati obstacle yang tidak ada saat takeoff</li>
                                <li>‚ö° Cepat dan sederhana, tidak butuh memory banyak</li>
                                <li>üéØ Cocok untuk area terbuka tanpa banyak obstacle</li>
                            </ul>
                            
                            <h5>üß≠ SmartRTL - Intelligent Path:</h5>
                            <ul>
                                <li>üõ§Ô∏è Mengikuti balik jalur terbang yang sudah dilalui</li>
                                <li>üß† Menyimpan "breadcrumb" path di memory selama flight</li>
                                <li>üõ°Ô∏è Menghindari obstacle yang sudah dilewati saat terbang keluar</li>
                                <li>üíæ Butuh memory untuk menyimpan path points</li>
                                <li>üèôÔ∏è Ideal untuk urban area atau area dengan banyak obstacle</li>
                                <li>‚ö†Ô∏è Fallback ke RTL jika memory penuh atau path tidak valid</li>
                            </ul>
                            
                            <h5>üìä Perbandingan Situasi:</h5>
                            <table class="config-table">
                                <thead>
                                    <tr>
                                        <th>Situasi</th>
                                        <th>RTL</th>
                                        <th>SmartRTL</th>
                                        <th>Rekomendasi</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Field terbuka</td>
                                        <td>‚úÖ Bagus</td>
                                        <td>‚úÖ Bagus</td>
                                        <td>RTL (lebih simple)</td>
                                    </tr>
                                    <tr>
                                        <td>Area urban</td>
                                        <td>‚ö†Ô∏è Risiko obstacle</td>
                                        <td>‚úÖ Sangat bagus</td>
                                        <td>SmartRTL</td>
                                    </tr>
                                    <tr>
                                        <td>Terbang jauh</td>
                                        <td>‚úÖ Reliable</td>
                                        <td>‚ö†Ô∏è Memory terbatas</td>
                                        <td>RTL</td>
                                    </tr>
                                    <tr>
                                        <td>Low memory FC</td>
                                        <td>‚úÖ Tidak masalah</td>
                                        <td>‚ùå Bisa kehabisan</td>
                                        <td>RTL</td>
                                    </tr>
                                    <tr>
                                        <td>FPV racing</td>
                                        <td>‚úÖ Cepat</td>
                                        <td>‚úÖ Aman</td>
                                        <td>SmartRTL</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="highlight-box">
                            <h4>üí° Tips Failsafe Configuration:</h4>
                            <ul>
                                <li><strong>Battery Priority</strong>: Critical=Land (langsung), Low=RTL (pulang dulu)</li>
                                <li><strong>RC Failsafe</strong>: RTL/SmartRTL berdasarkan environment</li>
                                <li><strong>Voltage Settings</strong>: Sesuaikan dengan jumlah cell baterai (3S: 10.5V, 4S: 14.0V, 6S: 21.0V)</li>
                                <li><strong>Testing</strong>: Selalu test failsafe di simulasi atau area aman</li>
                                <li><strong>SmartRTL Setup</strong>: Enable dengan <code>SRTL_ENABLE=1</code></li>
                                <li><strong>Hybrid Option</strong>: "SmartRTL or Land" = best of both worlds</li>
                            </ul>
                        </div>
                        
                        <div class="alert alert-warning">
                            <strong>‚ö†Ô∏è PENTING:</strong> 
                            <ul>
                                <li>Jangan pernah set failsafe ke "None" atau "Terminate" kecuali situasi khusus</li>
                                <li>Test semua failsafe di area terbuka dan aman</li>
                                <li>Pastikan Home position sudah ter-set sebelum takeoff</li>
                                <li>Monitor voltage dan signal strength secara real-time</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" class="step-check" data-step="13">
                        <span>Failsafe configuration sudah dikonfigurasi dengan aman</span>
                    </label>
                </div>
            </section>

            <!-- Step 14: Acro Settings -->
            <section class="step-content" id="step14" style="display:none;">
                <h2>14. Acro Settings</h2>
                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>Disable Acro Trainer</h3>
                        <div class="param-item">
                            <code>ACRO_TRAINER = 0</code>
                            <span>Disable trainer untuk full acro mode</span>
                        </div>
                        <div class="alert alert-info">
                            <strong>üí° Info:</strong> Dengan trainer disabled, Anda mendapat kontrol penuh dalam mode Acro
                        </div>
                    </div>
                </div>
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" class="step-check" data-step="14">
                        <span>Acro trainer sudah di-disable</span>
                    </label>
                </div>
            </section>

            <!-- Step 15: Initial Tuning Parameters -->
            <section class="step-content" id="step15" style="display:none;">
                <h2>15. Initial Tuning Parameters</h2>
                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>Parameter Tuning untuk 5 inch 6S</h3>
                        <p>Copy dan paste parameter berikut ke Mission Planner:</p>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyParams()">üìã Copy Parameters</button>
                            <pre id="tuningParams">ANGLE_MAX,6000
ARMING_CHECK,1
RC2_REVERSED,1
ATC_ACCEL_P_MAX,162000
ATC_ACCEL_R_MAX,162000
ATC_ACCEL_Y_MAX,56000
ATC_ANG_PIT_P,12
ATC_ANG_RLL_P,12
ATC_ANG_YAW_P,6
ATC_RAT_PIT_D,0.001
ATC_RAT_PIT_I,0.06
ATC_RAT_PIT_P,0.06
ATC_RAT_PIT_SMAX,0
ATC_RAT_RLL_D,0.001
ATC_RAT_RLL_I,0.06
ATC_RAT_RLL_P,0.06
ATC_RAT_RLL_SMAX,0
ATC_RAT_YAW_D,0.002
ATC_RAT_YAW_I,0.02
ATC_RAT_YAW_P,0.2
ATC_RAT_YAW_SMAX,0
BATT_ARM_VOLT,22.10
BATT_CRT_VOLT,21.00
BATT_LOW_VOLT,21.60
GPS1_GNSS_MODE,5
GPS2_GNSS_MODE,5
GPS_AUTO_SWITCH,1
GPS_BLEND_MASK,5
INS_HNTCH_BW,30
INS_HNTCH_FREQ,140
INS_HNTCH_HMNCS,1
INS_HNTCH_OPTS,6
INS_LOG_BAT_OPT,4
LOG_BITMASK,180222
MOT_BAT_VOLT_MIN,19.80
PSC_ACCZ_I,0.26
PSC_ACCZ_P,0.13
PSC_VELZ_P,3
SERVO_BLH_AUTO,1
SERVO_DSHOT_ESC,2</pre>
                        </div>
                    </div>
                </div>
                
                <div class="highlight-box">
                    <h4>‚ö†Ô∏è Perhatian Khusus: RC2_REVERSED Parameter</h4>
                    <p><strong>RC2_REVERSED=1</strong> adalah parameter penting yang <em>berbeda dengan Betaflight</em>:</p>
                    <ul>
                        <li>üî¥ <strong>Betaflight</strong>: Throttle stick naik = throttle naik (normal)</li>
                        <li>üü¢ <strong>ArduPilot</strong>: Perlu RC2_REVERSED=1 untuk matching Betaflight behavior</li>
                        <li>üì° <strong>Tanpa parameter ini</strong>: Throttle stick akan terbalik (berbahaya!)</li>
                        <li>‚úÖ <strong>Solusi</strong>: Pastikan RC2_REVERSED=1 sudah ter-set untuk konsistensi</li>
                    </ul>
                </div>
                
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" class="step-check" data-step="15">
                        <span>Initial tuning parameters sudah di-load</span>
                    </label>
                </div>
            </section>

            <!-- Step 16: Remote Control -->
            <section class="step-content" id="step16" style="display:none;">
                <h2>16. Remote Control Settings</h2>
                <div class="instruction-card">
                    <div class="instruction-content">
                        <h3>Radiomaster Pocket ELRS</h3>
                        <ul>
                            <li>Internal TX Firmware: <strong>3.5.4</strong></li>
                            <li>Backpack Firmware: <strong>1.5.2</strong></li>
                        </ul>
                        <h4>Switch Mapping:</h4>
                        <table class="config-table">
                            <thead>
                                <tr>
                                    <th>Switch</th>
                                    <th>Type</th>
                                    <th>Channel</th>
                                    <th>Fungsi</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>A</td>
                                    <td>2 pos</td>
                                    <td>5</td>
                                    <td>Arming</td>
                                </tr>
                                <tr>
                                    <td>B</td>
                                    <td>3 pos</td>
                                    <td>7</td>
                                    <td>Flight Mode 1</td>
                                </tr>
                                <tr>
                                    <td>D</td>
                                    <td>2 pos</td>
                                    <td>7</td>
                                    <td>Flight Mode 2</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="image-gallery">
                        <img src="../ardupilot/nazgul/img/mixes-01-all.jpg" alt="All Mixes" class="gallery-img">
                        <img src="../ardupilot/nazgul/img/mixes-02-flymod.jpg" alt="Flight Mode Mix" class="gallery-img">
                    </div>
                </div>
                <div class="checklist">
                    <label class="checkbox-item">
                        <input type="checkbox" class="step-check" data-step="16">
                        <span>Remote control sudah dikonfigurasi</span>
                    </label>
                </div>
            </section>

            <!-- Completion -->
            <section class="step-content" id="step17" style="display:none;">
                <h2>üéâ Setup Selesai!</h2>
                <div class="completion-card">
                    <div class="success-icon">‚úÖ</div>
                    <h3>Selamat! Setup ArduPilot Anda sudah selesai</h3>
                    <p>Drone Anda sekarang siap untuk test flight. Pastikan untuk:</p>
                    <ul class="final-checklist">
                        <li>‚úì Double check semua koneksi fisik</li>
                        <li>‚úì Kalibrasi compass dan accelerometer</li>
                        <li>‚úì Test semua flight mode di area yang aman</li>
                        <li>‚úì Mulai dengan hover test di mode Stabilize</li>
                        <li>‚úì Simpan backup parameter setelah tuning selesai</li>
                    </ul>
                    <div class="alert alert-success">
                        <strong>üíæ Backup:</strong> Jangan lupa save parameter ke file untuk backup!
                    </div>
                    <button class="btn-primary" onclick="resetGuide()">üîÑ Mulai Ulang</button>
                </div>
            </section>
        </main>

        <footer>
            <p>UAV Configuration Guide | ArduPilot Nazgul Setup</p>
            <p><a href="https://github.com/endymuhardin/uav-configuration" target="_blank">GitHub Repository</a></p>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>